<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Simple App Engine</title>
  <script>
    var loadedJS = {};
    var loadedCSS = [];
    function loadJs(src, nodeName) {
      if (loadedJS[nodeName]) {
        // remove existing one
        try {
          document.head.removeChild(loadedJS[nodeName]);
        } catch (e) {
          console.log('ERROR:', e);
        }
        loadedJS[nodeName] = null;
      }
      if (!loadedJS[src]) {
        var s = document.createElement('script');
        s.setAttribute("type", "text/javascript");
        s.setAttribute('defer', 'defer');
        s.setAttribute("src", src);
        document.head.appendChild(s);
        if (!nodeName) nodeName = src;
        loadedJS[nodeName] = s;
        console.log('script: ' + src + ' is loaded');
      } else {
        // remove it and load again
        try {
          console.log('remove already loaded script and reload');
          document.head.removeChild(loadedJS[src]);
          // then load again...
          loadedJS[src] = null;
          loadJs(src);
        } catch (e) {
          console.log('ERROR', e);
        }
      }
    }
    function loadCss(src) {
      if (!loadedCSS[src]) {
        var s = document.createElement('link');
        s.setAttribute("rel", "stylesheet");
        s.setAttribute("href", src);
        document.head.appendChild(s);
        loadedCSS[src] = s;
        console.log('style: ' + src + ' is loaded');
      }
    }

    // load page by hash
    window.currentPage = '';
    window.loadPage = function (hash) {
      var page;
      if (!hash) {
        page = 'home';
      } else {
        page = hash.replace('#', '');
      }
      if (page == window.currentPage) {
        return;
      }
      window.page = currentPage;
      page = 'pages/' + page + '.js';
      console.log('load page: ' + page);
      loadJs(page, '_page');
    };
    // run initially
    loadPage(window.location.hash);
  </script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" id="nav"></nav>
<div class="container" id="apps"></div>

<script>
  !function(t){"use strict"
    t.SimpleAppStart="sta",t.SimpleAppFinish="fin",t.SimpleAppWillRender="wrd",t.SimpleAppDidRender="drd",t.SimpleAppRenderElement="rde",t.SimpleAppParseElementData="ped",t.SimpleAppStateIsUpdated="siu",String.prototype.hashCode=function(){var t,e,i,a=0
      if(0===this.length)return a
      for(t=0,i=this.length;i>t;t++)e=this.charCodeAt(t),a=(a<<5)-a+e,a|=0
      return Math.abs(a)}
    var e=function(t){return JSON.stringify(t)},i=function(t){return JSON.parse(JSON.stringify(t))},a=function(a,s){a=e(a).hashCode()
      var n="_sj_"+a
      if(this.name=a,t[n]=this,this.localStorageKey=n+"_data",this.container=null,this.state={},this.pState={},this.cnf={localStorageWrite:!0,localStorageRead:!0,partialRender:!0},"object"==typeof s)for(var r in s)this.cnf[r]=s[r]
      this.cr={sta:{},fin:{},wrd:{},drd:{},rde:{},ped:{},siu:{}},this.gc=function(t,e){return e?"function"==typeof this.cr[t][e]?this.cr[t][e]:void 0:this.cr[t]},this.on=function(t,e,i){"object"==typeof this.cr[t]&&"function"==typeof i&&(this.cr[t][e]=i)},this._f=function(t){var e=this.gc(t)
        if("object"==typeof e)for(var i in e){var a=e[i]
          "function"==typeof a&&a()}},this.updateState=function(t,e){var i,a,s
        if("string"==typeof t)i=t,a=e,this.state[t]=e
        else if("object"==typeof t&&"string"==typeof t.nodeName){s=t
          var n=s.nodeName,r=s.type
          switch("SELECT"==n&&(r="select"),i=s.name,a=s.value,r){case"select":case"text":case"radio":this.state[i]=a
            break
            case"checkbox":if(this.state[i]||(this.state[i]=[]),s.checked&&a.length>0)this.state[i].indexOf(a)<0&&this.state[i].push(a)
            else{var h=this.state[i].indexOf(a)
              h>=0&&this.state[i].splice(h,1)}break
            default:this.state[i]=a}}this.store(),this.stateIsUpdated({name:i,value:a,element:s,state:this.state})},this.stateIsUpdated=function(t){var e=this.gc("siu",t.name)
        return"function"==typeof e?e(t):t},this.htmlTemplate=function(t,e){try{var i=t
        for(var a in e)if(a.length>0){var s=new RegExp("{"+a+"}","g"),n=e[a]
          i=i.replace(s,n)}return i}catch(r){return""}},this.store=function(){this.cnf.localStorageWrite&&"object"==typeof window.localStorage&&window.localStorage.setItem(this.localStorageKey,e(this.state))},this.load=function(){if(this.cnf.localStorageRead&&"object"==typeof window.localStorage){var t=window.localStorage.getItem(this.localStorageKey)
        if(!t)return
        try{this.state=JSON.parse(t)}catch(e){}}},this.template={main:{},sub:{}},this.data={},this.pData={},this.cache={},this.els=function(t,i,a){if(a._style)return a._style
        if(i){var s=e(i),n=e(a.value)
          return s.indexOf(n)>=0?"selected":"default"}return"default"},this.eId=function(t){return n+"_el_"+t},this.parseElementData=function(t,i,a,s,r){a||(a={})
        var h=this.gc("ped",t)
        if("function"==typeof h)return h(i,a)
        var l=["accesskey","name","class","dir","id","lang","style","tabindex","title","src","type","placeholder","selected","checked","readonly","disabled","target","media","href","value"],o={},c=[]
        a.name=t,r>0?"select"!=s&&(a.id||(a.id=this.eId(t+"_"+r))):a.id||(a.id=this.eId(t))
        var p=n+".updateState(this)"
        if(!r)switch(s){case"select":a.onchange=p
          break
          case"input":a.onkeyup=p,a.value||(a.value=i)
            break
          default:s&&(a.onclick=p)}o.selectState="",r>0&&e(i).indexOf(e(a.value))>=0&&("select"==s&&(a.selected="selected",o.selectState='selected="selected"'),("checkbox"==s||"radio"==s)&&(a.checked="checked",o.selectState='checked="checked"'))
        for(var d in a)o[d]=a[d],(l.indexOf(d)>=0||0==d.indexOf("data-")||0==d.indexOf("on"))&&c.push(d+'="'+a[d]+'"')
        return o.attr=c.join(" "),o.action=p,o},this.node=function(t){return document.getElementById(this.eId(t))},this.style="default",this.h2n=function(t,e){var i=e.parentElement
        if(i){var a=i.cloneNode()
          a.innerHTML=t,i.replaceChild(a.firstChild,e)}},this.render=function(t){if(this._f("wrd"),t=t===!0,!this.container)throw new Error("Invalid container specified")
        var a=this.style,s=this.template.main[a],n=this.cache
        if(!s)throw new Error("Invalid master template for style: "+a)
        var r=t
        for(var h in this.template.sub)if(this.cnf.partialRender&&e(this.state[h])==e(this.pState[h])&&"string"==typeof n[h]&&e(this.data[h])==e(this.pData[h])&&!t);else{var l=this.renderElement(h,t),o=this.node(h)
          o?"string"==typeof l&&l.length>0&&this.h2n(l,o):"string"==typeof l&&l.length>0&&(n[h]=l,r=!0)}this.pState=i(this.state),this.pData=i(this.data),r&&(this.container.innerHTML=this.htmlTemplate(s,n),this._f("drd"))},this.renderElement=function(t,a){if(a=a===!0,"object"!=typeof this.template.sub[t])return""
        var s=this.data[t]||{},n=this.state[t]||"",r="",h=this.gc("rde",t)
        if("function"==typeof h)return h(n,s)
        var l=this.template.sub[t],o=(l._type,this)
        if(l._wrapper){s.wrapper||(s.wrapper={})
          var c=this.parseElementData(t,n,s.wrapper,l._type),p=s.element||[],d=0
          p.map(function(s){d++
            var h=i(s),c=o.els(t,n,h),p=o.template.sub[t][c],f=o.parseElementData(t,n,h,l._type,d)
            p||(p=o.template.sub[t]["default"])
            var u=o.node(t+"_"+d),m=o.htmlTemplate(p,f)
            if(u&&o.cnf.partialRender&&!a){var v=d-1,y=e(o.pData[t].element[v]),g=e(o.data[t].element[v])
              y!=g&&o.h2n(m,u)}else r+=m}),"string"==typeof r&&r.length>1&&(r=o.htmlTemplate(l._wrapper[0],c)+r+l._wrapper[1])}else{var f=this.els(t,n,s),u=this.template.sub[t][f],m=this.parseElementData(t,n,s,l._type)
          u||(u=this.template.sub[t]["default"]),r+=this.htmlTemplate(u,m)}return r},this.init=function(t,e){t&&(this.container=t),this.load(),e!==!1&&(this._f("sta"),this.render(),this._f("fin"))},this.toQuerystring=function(){var t=[]
        for(var e in this.state){var i=this.state[e]
          i&&t.push(e+"="+i)}return t.join("&")},this.d=function(t,e){return e?"object"==typeof this.data[t].element&&this.data[t].element[e]?this.data[t].element[e]:void 0:this.data[t]}},s={}
    t.SimpleApp=function(t,e){return s[t]||(s[t]=new a(t,e)),s[t]},"undefined"!=typeof exports&&(exports.SimpleApp=t.SimpleApp,exports.SimpleEvent=t.SimpleEvent)}(this)
</script>
<script src="js/jquery.js"></script>
<script async src="js/bootstrap.min.js"></script>
<script async src="apps/nav.js"></script>
<script>loadCss('theme/read.css');</script>
</body>
</html>
